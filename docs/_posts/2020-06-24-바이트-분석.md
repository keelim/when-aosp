---
layout: post
title: "ë°”ì´íŠ¸ ì½”ë“œ ë¶„ì„"
date: 2020-06-24 00:00:01
author: Keelim
categories: AOSP
comments: true
toc: true
toc_sticky: true
---

## ì•„ì´ë””ì–´ í™•ì¸

ì•„ì´ë””ì–´ë¥¼ ì°¸ê³ ë¥¼ í•˜ì—¬ ë°”ì´íŠ¸ ì½”ë“œë¥¼ ë¶„ì„ì„ í•œ í›„ -> ì„±ëŠ¥ ì¸¡ì •ì„ í™•ì¸ 

### ê¸°ì¡´ ì½”ë“œ (ë°”ì´íŠ¸ ì½”ë“œ)

### switch (ë°”ì´íŠ¸ ì½”ë“œ)

### HashMap, EnumMap (ë°”ì´íŠ¸ ì½”ë“œ)

ì´ì „ ì»¨í…íŠ¸ í”„ë¡œë°”ì´ë” í”„ë¡œì íŠ¸ì—ì„œ hashmap, enummap ì— ëŒ€í•˜ì—¬ ë¹„êµí•˜ê³ 
EnumMap ì´ í‚¤ê°’ì´ ê°€ì§ˆ ê²½ìš° ì›”ë“±ì´ ë¹ ë¥¸ ê²ƒìœ¼ë¡œ ì¸¡ì •ì„ í•¨.

![EnumMap](https://user-images.githubusercontent.com/38609712/63910227-d0302c80-ca60-11e9-8958-6890ccd4c7a8.png)

`ì ìš©í•  ìˆ˜ ìˆëŠ” ë¶€ë¶„` ì´ WindowManger íŒŒíŠ¸ì—ì„œë„ ì¡´ì¬ í•˜ëŠ” ê²ƒì„ í™•ì¸ -> `WindowHashMap class`

#### í˜„ì¬ ë¬¸ì œ ë°”ì´íŠ¸ ì½”ë“œ

2020.06.21 import err, syntax err, conversion err í•´ê²°ì´ ê°€ëŠ¥í•œê°€?

2020.06.22 í´ë˜ìŠ¤ë¥¼ ì „ë¶€ ì°¸ì¡°ë¥¼ í•´ì•¼ í•˜ëŠ”ë° ì´ í´ë˜ìŠ¤ë§Œ ë°”ì´íŠ¸ ì½”ë“œë¡œ ë§Œë“¤ ìˆ˜ ì—†ëŠ” ê²ƒ ê°™ë‹¤.

2020.06.23 ì¼ë‹¨ ë¹„ìŠ·í•˜ê²Œ í–ˆë˜ ê²ƒë“¤ ì „ë¶€ ì°¾ì•„ë³´ê¸° --> force compile ë„ ì‹¤íŒ¨

2020.06.24 ì§„í–‰ ì•ˆë  ê²½ìš° -> ì¼ë‹¨ ë‹¤ë¥¸ ë°©ë²•ìœ¼ë¡œ ë„˜ì–´ê°€ê¸° (ê¸°ì¡´ í”„ë¡œì íŠ¸ ìë£Œ ì°¸ì¡°)
            --> ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ë¥¼ ì´ìš©ì„ í•´ì„œ ë°”ì´íŠ¸ ì½”ë“œë¥¼ ì–»ëŠ” ë°©ë²•(ContentProvider team)
            --> HashMap ë³´ë‹¤ëŠ” EnumMapì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ íš¨ìœ¨ì (ContentProvider team) javac ìœ¼ë¡œëŠ” `ì»´íŒŒì¼ ë¶ˆê°€ í™•ì •`
            --> ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ í•´ë³´ê¸°

![force_compile](https://github.com/keelim/AOSP/blob/master/docs/assets/force_compile.png?raw=true)
2020.06.25  [ê°•ì œ ì»´íŒŒì¼]<> --> force build class íŒŒì¼ ê°•ì œë¡œ ë§Œë“¤ê¸°
            --> í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ì‘ì„±ì€ ìƒê°ë³´ë‹¤ í˜ë“¤ë‹¤. (-> ContentProvider íŒ€ì˜ ê²½ìš° withValue í•¨ìˆ˜ì˜ ì„±ëŠ¥ ì¸¡ì •ì„ í•˜ëŠ” íŒŒë¼ë¯¸í„°ê°€
            ë‹¨ìˆœ String, Object type)  `í•˜ì§€ë§Œ` addWindow ì˜ ê²½ìš°ëŠ” Parameter ê°ì¢… í´ë˜ìŠ¤ íƒ€ì…ê³¼ ë¶ˆë¦¬ì–¸ íƒ€ì… --> ì„ì˜ë¡œ ì •í•˜ê¸° í˜ë“¤ë‹¤.

```shell
javap -c > WindowManagerService.class > compile.txt

```

ë¡œ ë°”ì´íŠ¸ ì½”ë“œë¥¼ `txt` íŒŒì¼ë¡œ ì €ì¥ì„ í•  ìˆ˜ ìˆë‹¤.

```java
  public int addWindow(Session, IWindow, int, LayoutParams, int, int, Rect, Rect, Rect, Rect, DisplayCutout.ParcelableWrapper, InputChannel, InsetsState);
    Code:
       0: new           #304                // class java/lang/Error
       3: dup
       4: ldc_w         #306                // String Unresolved compilation problem: \n
       7: invokespecial #308                // Method java/lang/Error."<init>":(Ljava/lang/String;)V
      10: athrow
```

`í•˜ì§€ë§Œ` ì—ëŸ¬ê°€ ë‚˜ì˜¤ëŠ” ë°”ì´íŠ¸ ì½”ë“œë¥¼ í™•ì¸ì„ í•  ìˆ˜ ìˆë‹¤. -> ì œì¼ ì¤‘ìš”í•œ ê±´ ë¹Œë“œ í™˜ê²½ì„ êµ¬ì„±í•´ì•¼ ë°”ì´íŠ¸ ì½”ë“œë¥¼ ë¶„ì„ì„ í•  ìˆ˜ ìˆë‹¤.

ë¹Œë“œ í™˜ê²½1: aosp api 27(oreo) ~ api 30(master, Q) ê¹Œì§€?
ë¹Œë“œ í™˜ê²½2: pure Linux(Ubuntu) ~ (wsl, window subsystem linux) + docker
ë¹Œë“œ í™˜ê²½3: samsung ê³µê¸°ê¸° ~ Google pixel 1 (Nexux line ë¹Œë“œ í™˜ê²½ ê°ë‹¹ ëª»í•  ê²ƒìœ¼ë¡œ ì˜ˆìƒ, ë„¥ì„œìŠ¤ ê³ ë ¤í•  ê²½ìš° ì»¤ìŠ¤í…€ê¹Œì§€ í•´ì•¼ í•œë‹¤.)

#### í”„ë¡œì íŠ¸ì—ì„œ í•´ì•¼ í• ì¼

1. ë¹Œë“œ í™˜ê²½ êµ¬ì„± --> ë¹ ë¥¸ ì‹œì¼ ë‚´ì—
2. WindowMangerService addWindow ë¶„ì„ ì¤‘ì´ì§€ë§Œ ë‹¤ë¥¸ ì˜ì‹¬ êµ¬ì—­ì€ ë°”ë¡œ ì°¾ê¸°

    - `í˜„ì¬ ëª©í‘œ:` WindowManager ê´€ë ¨ ë¶€ë¶„ (Viewë¥¼ ê·¸ë¦¬ëŠ” ë¶€ë¶„ì€ ì¼ë‹¨ ì œì™¸)
    - kotlin, gloalLock ì˜ ê²½ìš°ëŠ” ë¹Œë“œ ì‹œ ì–´ë ¤ìš¸ ìˆ˜ ìˆì„ ê²ƒ ê°™ë‹¤.
    - ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” ìˆì§€ë§Œ ì‚¬ìš©í•˜ì§€ëŠ” ëª»í•  ê²ƒ ê°™ë‹¤. (ê°œì¸ ë¼ì´ë¸ŒëŸ¬ë¦¬)
    - ë¹„ìŠ·í•œ ë¹„ë™ê¸°ì  ì²˜ë¦¬ë¥¼ í•  ìˆ˜ ìˆëŠ” ê²ƒì€ `RxJava`
    - ë§Œì¼ì˜ ê²½ìš° `View` ë¥¼ ê·¸ë¦¬ëŠ” ë¶€ë¶„ìœ¼ë¡œ

3. ì¼ë‹¨ ê¸°ê¸°ëŠ” sm ì€ ì˜¤ë”˜ì„ ì‚¬ìš©ì„ í•´ì„œ í¬íŒ… í•´ì•¼ í•œë‹¤. ë‹¤ë¥¸ Big ì œì¡°ì‚¬ë“¤ë„ ì˜¤ë”˜í•˜ê³  ë¹„ìŠ·í•˜ë‹¤. ê³µê¸°ê¸° ë“±ì´ ìˆì§€ë§Œ Google pixel line ì°¾ì•„ë³¼ ê²ƒ

## ì°¸ê³  ë¬¸í—Œ

- [<https://developer.android.com/>]
- [<http://oss.kr/]>
- [<https://cs.android.com/>]
- ì¸ì‚¬ì´ë“œ ì•ˆë“œë¡œì´ë“œ

#### ğŸ§¶ ëª¨ë“  ë¬¸ì„œëŠ” ìˆ˜ì •ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
